# Click the Variables button, above, to create your own variables

PUT construction
{
  "mappings": {
    "properties": {
      "project_id": { "type": "keyword" },
      "project_name": { "type": "text" },
      "foreman_id": { "type": "keyword" },
      "work_stages": {
        "type": "nested",
        "properties": {
          "stage_id": { "type": "keyword" },
          "stage_name": { "type": "text" },
          "stage_status": { "type": "keyword" },
          "work_types": {
            "type": "nested",
            "properties": {
              "work_type_id": { "type": "keyword" },
              "work_type_name": { "type": "text" },
              "tasks": {
                "type": "nested",
                "properties": {
                  "task_id": { "type": "keyword" },
                  "task_name": { "type": "text" },
                  "task_description": { "type": "text" },
                  "task_status": { "type": "keyword" },
                  "time_intervals": {
                    "type": "nested",
                    "properties": {
                      "start_time": { "type": "date" },
                      "end_time": { "type": "date" },
                      "status": { "type": "keyword" }
                    }
                  },
                  "subtasks": {
                    "type": "nested",
                    "properties": {
                      "subtask_id": { "type": "keyword" },
                      "subtask_name": { "type": "text" },
                      "subtask_status": { "type": "keyword" },
                      "subtask_description": { "type": "text" },
                      "time_intervals": {
                        "type": "nested",
                        "properties": {
                          "start_time": { "type": "date" },
                          "end_time": { "type": "date" },
                          "status": { "type": "keyword" }
                        }
                      },
                      "assignees": { "type": "keyword" },
                      "deadline": { "type": "date" },
                      "plannedQty": { "type": "float" },
                      "actualQty": { "type": "float" },
                      "machine": {
                        "type": "object",
                        "properties": {
                          "hours": { "type": "float" },
                          "units": { "type": "float" }
                        }
                      },
                      "reportLinks": {
                        "type": "nested",
                        "properties": {
                          "title": { "type": "text" },
                          "href": { "type": "keyword" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}



POST construction/_doc
{
  "project_id": "p1",
  "project_name": "Строительство жилого дома",
  "foreman_email": "user@example.com",
  "foreman_id": "ebaf42b2-c945-400d-bb11-6a17f9e4a0dc",
  "work_stages": [
    {
      "stage_id": "s1",
      "stage_name": "Фундамент",
      "stage_status": "В работе",
      "work_types": [
        {
          "work_type_id": "wt1",
          "work_type_name": "Заливка бетона",
          "work_status": "В работе",
          "tasks": [
            {
              "task_id": "t1",
              "task_name": "Подготовка площадки",
              "task_description": "Очистка территории перед заливкой бетона",
              "task_status": "Завершено",
              "subtasks": [
                {
                  "subtask_id": "st1",
                  "subtask_name": "Вывоз мусора",
                  "subtask_status": "Завершено",
                  "subtask_description": "Убрать строительный мусор",
                  "assignees": ["worker1", "worker2"],
                  "deadline": "2025-08-20",
                  "plannedQty": 10,
                  "actualQty": 12,
                  "machine": {
                    "hours": 5,
                    "units": 2
                  },
                  "reportLinks": [
                    { "title": "Фото отчёт", "href": "http://example.com/report1" }
                  ],
                  "time_intervals": [
                    {
                      "start_time": "2025-08-16T08:00:00",
                      "end_time": "2025-08-16T17:00:00",
                      "status": "closed"
                    }
                  ]
                },
                {
                  "subtask_id": "st2",
                  "subtask_name": "Разметка территории",
                  "subtask_status": "Завершено",
                  "subtask_description": "Разметить границы фундамента",
                  "assignees": ["worker3"],
                  "deadline": "2025-08-18",
                  "plannedQty": 5,
                  "actualQty": 5,
                  "machine": {
                    "hours": 5,
                    "units": 2
                  },
                  "reportLinks": [],
                  "time_intervals": [
                    {
                      "start_time": "2025-08-16T08:00:00",
                      "end_time": "2025-08-16T17:00:00",
                      "status": "closed"
                    }
                  ]
                }
              ]
            },
            {
              "task_id": "t2",
              "task_name": "Армирование",
              "task_status": "В работе",
              "task_description": "Установка арматурного каркаса",
              "time_intervals": [
                {
                  "start_time": "2025-08-16T08:00:00",
                  "end_time": "2025-08-16T17:00:00",
                  "status": "closed"
                },
                {
                  "start_time": "2025-08-17T08:00:00",
                  "status": "active"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "stage_id": "s2",
      "stage_name": "Стены",
      "stage_status": "",
      "work_types": [
        {
          "work_type_id": "wt2",
          "work_type_name": "Кладка кирпича",
          "tasks": [
            {
              "task_id": "t3",
              "task_name": "Первая линия кладки",
              "task_description": "Укладка первого ряда кирпичей",
              "time_intervals": []
            }
          ]
        }
      ]
    }
  ]
}



DELETE construction
GET construction/_refresh


PUT users
{
  "settings": {
    "analysis": {
      "normalizer": {
        "lowercase_norm": {
          "type": "custom",
          "filter": ["lowercase"]
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "email": {
        "type": "keyword",
        "normalizer": "lowercase_norm"
      },
      "hashed_password": { "type": "keyword" },
      "role": { "type": "keyword" },
      "is_active": { "type": "boolean" },
      "created_at": { "type": "date" }
    }
  }
}

GET users/_refresh
GET users/_search
DELETE users
DELETE construction
GET construction/_search

GET construction/_refresh

POST users/_update/0d2d6c94-377a-46c8-9051-842bb1330bcc
{
  "doc": {
    "role": "root"
  }
}